__NUXT_JSONP__("/documentation/Good2Know/windowsarchitecture", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U){return {data:[{article:{slug:y,description:r,title:z,order:n,toc:[{id:A,depth:s,text:B},{id:C,depth:s,text:t},{id:D,depth:E,text:F},{id:G,depth:E,text:H}],body:{type:"root",children:[{type:b,tag:"h1",props:{id:"windows-architecture"},children:[{type:b,tag:g,props:{href:"#windows-architecture",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:r}]},{type:a,value:c},{type:b,tag:I,props:{id:A},children:[{type:b,tag:g,props:{href:"#index",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:"ul",props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:b,tag:g,props:{href:J},children:[{type:a,value:t}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:I,props:{id:C},children:[{type:b,tag:g,props:{href:J,ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:t}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"Source"}]},{type:a,value:":  "},{type:b,tag:g,props:{href:K,rel:[u,v,w],target:x},children:[{type:a,value:K}]}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"Usage"}]},{type:a,value:": [[Optimum]]"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"This part is to highlight the importance of knowing the process architecture for the running PowerShell process."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"Just calling "},{type:b,tag:f,props:{},children:[{type:a,value:"powershell"}]},{type:a,value:" CAN return a process that is running as a 32-bit process (in a x64 Windows Architecture!!)"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"To check if the shell process is running in 64bit architecture:"}]},{type:a,value:c},{type:b,tag:"blockquote",props:{},children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:f,props:{},children:[{type:a,value:"[Environment]::Is64BitProcess"}]},{type:a,value:"\nFalse | True"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"This table (stolen from "},{type:b,tag:g,props:{href:"https:\u002F\u002Fss64.com\u002Fnt\u002Fsyntax-64bit.html",rel:[u,v,w],target:x},children:[{type:a,value:"ss64.com"}]},{type:a,value:") show how the different paths work based on the current session architecture:"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:L,props:{alt:"Table Architecture",src:"\u002Fimages\u002Fdocs\u002Fg2k\u002Fwindowsarchitecture\u002Fss64_table_architecture.png"},children:[]}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"So, 64 bit versions of Windows have dynamic system folder "},{type:b,tag:f,props:{},children:[{type:a,value:"C:\\Windows\\sys*"}]},{type:a,value:" to support both 64 and 32 bit programs. "},{type:b,tag:f,props:{},children:[{type:a,value:"Powershell.exe"}]},{type:a,value:", "},{type:b,tag:f,props:{},children:[{type:a,value:"CMD.exe"}]},{type:a,value:" and many other porograms are available as both 32 bit or 64 bit."}]},{type:a,value:c},{type:b,tag:M,props:{id:D},children:[{type:b,tag:g,props:{href:"#what-does-that-mean",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:F}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"First we need to know the possible combinations of 64 and 32 bit architectures."}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:L,props:{alt:"SS64 combinations",src:"\u002Fimages\u002Fdocs\u002Fg2k\u002Fwindowsarchitecture\u002Fss64_combinations.png"},children:[]}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"So from this image and the one above we know that"}]},{type:a,value:c},{type:b,tag:N,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Being in a 64 bit OS "},{type:b,tag:d,props:{},children:[{type:a,value:"DOES NOT MEAN"}]},{type:a,value:" our program is 32 bit! And if we are trying to somehow modify or attack the Kernel o OS using a cmd or powershell in 32 bit won't work."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"In x64 OS there are actually 2 systems: "},{type:b,tag:d,props:{},children:[{type:a,value:"32 bit system"}]},{type:a,value:" and "},{type:b,tag:d,props:{},children:[{type:a,value:"64 bit system"}]},{type:a,value:" that can be accesed and contains versions of the programs in both architectures (if exists)"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"These leads us to know that if we want to execute "},{type:b,tag:f,props:{},children:[{type:a,value:"cmd.exe"}]},{type:a,value:" or "},{type:b,tag:f,props:{},children:[{type:a,value:"powershell.exe"}]},{type:a,value:" we could run either:"}]},{type:a,value:c},{type:b,tag:N,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:o},{type:b,tag:d,props:{},children:[{type:a,value:O}]},{type:a,value:p},{type:b,tag:d,props:{},children:[{type:a,value:P}]},{type:a,value:q},{type:b,tag:f,props:{},children:[{type:a,value:Q}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:o},{type:b,tag:d,props:{},children:[{type:a,value:O}]},{type:a,value:p},{type:b,tag:d,props:{},children:[{type:a,value:R}]},{type:a,value:q},{type:b,tag:f,props:{},children:[{type:a,value:"C:\\Windows\\sysNative\\cmd.exe"}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:o},{type:b,tag:d,props:{},children:[{type:a,value:S}]},{type:a,value:p},{type:b,tag:d,props:{},children:[{type:a,value:P}]},{type:a,value:q},{type:b,tag:f,props:{},children:[{type:a,value:"C:\\Windows\\sysWOW64\\cmd.exe"}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:o},{type:b,tag:d,props:{},children:[{type:a,value:S}]},{type:a,value:p},{type:b,tag:d,props:{},children:[{type:a,value:R}]},{type:a,value:q},{type:b,tag:f,props:{},children:[{type:a,value:Q}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:M,props:{id:G},children:[{type:b,tag:g,props:{href:"#did-you-know-",ariaHidden:i,tabIndex:j},children:[{type:b,tag:k,props:{className:[l,m]},children:[]}]},{type:a,value:H}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:"WOW64"}]},{type:a,value:" is a subsystem of the Windows Operating system. It means "},{type:b,tag:d,props:{},children:[{type:a,value:"Windows (32-bit) on a Windows 64-bit"}]},{type:a,value:" and enalbes 32-bit applications to work on a 64-bit operating system. More info on sysnative "},{type:b,tag:g,props:{href:"https:\u002F\u002Fcall4cloud.nl\u002F2021\u002F05\u002Fthe-sysnative-witch-project\u002F",rel:[u,v,w],target:x},children:[{type:a,value:"here"}]}]}]},dir:"\u002Fdocumentation\u002FGood2Know",path:T,extension:".md",createdAt:"2022-07-24T21:22:39.855Z",updatedAt:"2022-07-24T21:59:46.015Z"},articles:[{slug:"winexploitsuggester",description:"Windows Exploit Suggester",title:"WinExploit Suggester",order:s,path:"\u002Fdocumentation\u002FTools\u002Fwindowsexploitsuggester"},{slug:"filetransfer",description:"File transferring documentation",title:"File Transfer",order:n,path:"\u002Fdocumentation\u002FTechniques\u002Ffiletransfer"},{slug:y,description:r,title:z,order:n,path:T},{slug:"protocols",description:U,title:U,order:n,path:"\u002Fdocumentation\u002FTheory\u002Fprotocols"}]}],fetch:{},mutations:void 0}}("text","element","\n","strong","p","code","a","li","true",-1,"span","icon","icon-link",1,"In a "," as ",": ","Windows Architecture",2,"Powershell Shell Architecture","nofollow","noopener","noreferrer","_blank","windowsarchitecture","Windows Arch","index","Index","powershell-shell-architecture","what-does-that-mean",3,"What does that mean?","did-you-know-","Did you know ?","h2","#powershell-shell-architecture","https:\u002F\u002F0xdf.gitlab.io\u002F2021\u002F03\u002F17\u002Fhtb-optimum.html","img","h3","ol","32 bit CLI process","32 bit","C:\\Windows\\system32\\cmd.exe","64 bit","64 bit CLI process","\u002Fdocumentation\u002FGood2Know\u002Fwindowsarchitecture","Protocols")));